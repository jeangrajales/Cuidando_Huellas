{% extends 'administrador/base_sesion.html' %}
{% load static %}

{% block estilos_unicos %}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{% static 'css/usuarios/productos_usuarios.css' %}">
{% endblock %}

{% block titulo %} Productos {% endblock %}

{% block contenido %}
  <div class="container-fluid py-4">
      <!-- Notification Area -->
      <div id="notificaciones" class="mb-4">
          {% if messages %}
              {% for message in messages %}
                  <div class="alert alert-{% if message.tags and message.tags != 'error' %}{{ message.tags }}{% else %}danger{% endif %} alert-dismissible fade show" role="alert">
                      <div class="d-flex align-items-center">
                          <i class="fas {% if message.tags == 'success' %}fa-check-circle{% elif message.tags == 'warning' %}fa-exclamation-triangle{% else %}fa-info-circle{% endif %} me-2"></i>
                          <span>{{ message }}</span>
                      </div>
                      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                  </div>
              {% endfor %}
          {% endif %}
      </div>

      <!-- Header with search and cart -->
        <div class="row align-items-center mb-4">
          <div class="col-md-8">
              <h2 class="section-title">Nuestros Productos</h2>
              <p class="text-muted">Encuentra todo lo que necesitas para tus mascotas</p>
          </div>
          <div class="d-flex justify-content-end">
            <a href="#modalCarrito" 
               data-bs-toggle="modal" 
               data-bs-target="#modalCarrito" 
               class="btn btn-outline-primary cart-btn">
                <i class="fas fa-shopping-cart"></i>
                <span class="ms-2">Ver Carrito</span>
            </a>
          </div>
         </div>

      <!-- Product Categories -->
    

      <!-- Main Banner -->
      <div class="main-banner mb-5">
          <div class="row g-0">
              <div class="col-md-8">
                  <div class="banner-image">
                      <img src="{% static 'img/promocion.png' %}" alt="Banner Promocional" onerror="this.src='https://via.placeholder.com/800x400/3367d6/ffffff?text=Productos+para+Mascotas'">
                      <div class="banner-content">
                          <h2>Productos de calidad para tus mascotas</h2>
                          <p>Hasta 30% de descuento en productos seleccionados</p>
                          <a href="#" class="btn btn-light">Ver Ofertas</a>
                      </div>
                  </div>
              </div>
              <div class="col-md-4">
                  <div class="promo-banners">
                      <div class="promo-banner">
                          <img src="{% static 'img/accesorio.png' %}" alt="Promoción" onerror="this.src='https://via.placeholder.com/400x200/5f6368/ffffff?text=Accesorios'">
                          <div class="promo-content">
                              <h4>Accesorios</h4>
                              <a href="#" class="btn-link">Ver más</a>
                          </div>
                      </div>
                      <div class="promo-banner mt-3">
                          <img src="{% static 'img/alimento.png' %}" alt="Promoción" onerror="this.src='https://via.placeholder.com/400x200/5f6368/ffffff?text=Alimentos'">
                          <div class="promo-content">
                              <h4>Alimentos</h4>
                              <a href="#" class="btn-link">Ver más</a>
                          </div>
                      </div>
                  </div>
              </div>
          </div>
      </div>

      <!-- Featured Products Section with Side Layout -->
      <section class="featured-products mb-5">
          <h3 class="section-subtitle mb-4 fs-1">Productos Destacados</h3>
          <div class="row">
              <!-- Left Side Navigation -->
              <div class="col-md-3 d-none d-md-block">
                  <div class="category-sidebar">
                      <h4>Categorías</h4>
                      <ul class="category-list">
                          <li><a href="#"><i class="fas fa-paw me-2"></i>Alimentos</a></li>
                          <li><a href="#"><i class="fas fa-bone me-2"></i>Juguetes</a></li>
                          <li><a href="#"><i class="fas fa-home me-2"></i>Camas</a></li>
                          <li><a href="#"><i class="fas fa-pills me-2"></i>Salud</a></li>
                          <li><a href="#"><i class="fas fa-shower me-2"></i>Higiene</a></li>
                      </ul>
                      
                      <h4 class="mt-4">Marcas Populares</h4>
                      <div class="brands-list">
                          <span class="brand-tag">Royal Canin</span>
                          <span class="brand-tag">Purina</span>
                          <span class="brand-tag">Hill's</span>
                          <span class="brand-tag">Eukanuba</span>
                          <span class="brand-tag">Pedigree</span>
                      </div>
                  </div>
              </div>
              
              <!-- Right Side Products -->
              <div class="col-md-9">
                  <div class="row">
                      {% for producto in dato_producto_usuario|slice:":8" %}
                      <div class="col-md-3 col-sm-6 mb-4">
                          <div class="product-card-v2">
                              <div class="product-tags">
                                  <span class="product-tag new">Nuevo</span>
                                  {% if forloop.counter < 3 %}
                                  <span class="product-tag hot">Mas Vendidos</span>
                                  {% endif %}
                              </div>
                              <div class="product-image">
                                  {% if producto.foto_producto %}
                                      <img src="{{ producto.foto_producto.url }}" alt="{{ producto.nombre_producto }}">
                                  {% else %}
                                      <img src="{% static 'img/Collar Gato.png' %}" alt="Sin imagen" onerror="this.src='https://via.placeholder.com/300x300/f8f9fa/5f6368?text=Producto'">
                                  {% endif %}
                                  <div class="product-actions">
                                      <a href="{% url 'agregar_al_carrito' producto.id_producto %}" class="action-btn add-to-cart" title="Agregar al carrito">
                                          <i class="fas fa-shopping-cart"></i>
                                      </a>
                                      <button class="action-btn quick-view" title="Vista rápida">
                                          <i class="fas fa-eye"></i>
                                      </button>
                                      <button class="action-btn add-to-wishlist" title="Añadir a favoritos">
                                          <i class="far fa-heart"></i>
                                      </button>
                                  </div>
                              </div>
                              <div class="product-info">
                                  <h4 class="product-name">{{ producto.nombre_producto }}</h4>
                                  <div class="product-price">${{ producto.precio|floatformat:0 }}</div>
                                  <div class="product-meta">
                                      <span class="sold-count">
                                          <i class="fas fa-fire-alt me-1"></i>{{ forloop.counter0|add:5 }} vendidos
                                      </span>
                                  </div>
                              </div>
                          </div>
                      </div>
                      {% endfor %}
                  </div>
              </div>
          </div>
      </section>

      <!-- New Arrivals Section -->
      <!-- Productos Más Vendidos Section -->
        <section class="mb-5 new-arrivals-section">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h3 class="section-subtitle fs-1">Productos Más Vendidos</h3>
                <a href="#" class="btn btn-outline-primary">Ver todos los destacados</a>
            </div>

            <div class="row">
                {% for producto in productos_mas_vendidos %}
                <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 mb-4">
                    <div class="product-card-modern">
                        <div class="product-image">
                            {% if producto.foto_producto %}
                                <img src="{{ producto.foto_producto.url }}" alt="{{ producto.nombre_producto }}" class="img-fluid">
                            {% else %}
                                <img src="{% static 'img/default-product.png' %}" alt="Sin imagen" class="img-fluid">
                            {% endif %}
                            
                            <div class="product-badge">
                                {% if forloop.counter <= 3 %}
                                    <span class="badge bg-danger">TOP {{ forloop.counter }}</span>
                                {% else %}
                                    <span class="badge bg-success">POPULAR</span>
                                {% endif %}
                            </div>
                            
                            <div class="product-actions">
                                <a href="{% url 'agregar_al_carrito' producto.id_producto %}" class="action-btn cart-btn">
                                    <i class="fas fa-shopping-cart"></i>
                                </a>
                                <button class="action-btn quick-view" data-product-id="{{ producto.id_producto }}">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="product-details">
                            <div class="product-stats d-flex justify-content-between">
                                <span class="sales-count">
                                    <i class="fas fa-chart-line me-1"></i> {{ producto.veces_comprado }} compras
                                </span>
                                {% if producto.cantidad > 0 %}
                                    <span class="stock-available text-success">
                                        <i class="fas fa-check-circle"></i> Disponible
                                    </span>
                                {% else %}
                                    <span class="stock-out text-danger">
                                        <i class="fas fa-times-circle"></i> Agotado
                                    </span>
                                {% endif %}
                            </div>
                            
                            <h4 class="product-title">{{ producto.nombre_producto }}</h4>
                            
                            <div class="product-prices">
                                <span class="new-price">${{ producto.precio|floatformat:0 }}</span>
                                {% if producto.descuento > 0 %}
                                    <span class="discount-price">${{ producto.precio_sin_descuento|floatformat:0 }}</span>
                                {% endif %}
                            </div>
                            
                            <div class="d-grid mt-2">
                                <a href="{% url 'agregar_al_carrito' producto.id_producto %}" class="add-to-cart-btn {% if producto.cantidad <= 0 %}disabled{% endif %}">
                                    <i class="fas fa-cart-plus me-2"></i>
                                    {% if producto.cantidad > 0 %}Agregar al carrito{% else %}No disponible{% endif %}
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                {% empty %}
                <div class="col-12">
                    <div class="alert alert-info text-center">
                        <i class="fas fa-info-circle me-2"></i>
                        Aún no hay productos destacados. ¡Sé el primero en comprar!
                    </div>
                </div>
                {% endfor %}
            </div>
        </section>

      <!-- Trust indicators section -->
      <section class="trust-section">
          <div class="row text-center">
              <div class="col-md-3 col-6 mb-4">
                  <div class="trust-item">
                      <i class="fas fa-truck"></i>
                      <h5>Envío Gratis</h5>
                      <p>En pedidos sobre $30.000</p>
                  </div>
              </div>
              <div class="col-md-3 col-6 mb-4">
                  <div class="trust-item">
                      <i class="fas fa-shield-alt"></i>
                      <h5>Pago Seguro</h5>
                      <p>100% protección de datos</p>
                  </div>
              </div>
              <div class="col-md-3 col-6 mb-4">
                  <div class="trust-item">
                      <i class="fas fa-exchange-alt"></i>
                      <h5>Devoluciones</h5>
                      <p>Garantía de 30 días</p>
                  </div>
              </div>
              <div class="col-md-3 col-6 mb-4">
                  <div class="trust-item">
                      <i class="fas fa-headset"></i>
                      <h5>Soporte 24/7</h5>
                      <p>Atención personalizada</p>
                  </div>
              </div>
          </div>
      </section>
  </div>
  {% include 'usuarios/modal_carrito.html' %}
{% endblock %}